---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# STRINGDatabaseManipulation

The goal of STRINGDatabaseManipulation is to provide functions for working with STRING protein-protein interaction networks.

## Installation

Only the development version of STRINGDatabaseManipulation is available. 
You will also need the `graph` package from Bioconductor.

``` r
install.packages("BiocManager")
BiocManager::install("graph")
remotes::install_github("rmflight/STRINGDatabaseManipulation")
```

## Issues

If you have a question about how to use the package, a request for something new to be implemented, or have a bug, please [file an issue](https://github.com/rmflight/STRINGDatabaseManipulation/issues).

## Getting Data

This package works with preprocessed data from STRING itself. 

You can preprocess files from STRING by downloading detail and alias files.

For example, for human you can download the detail file by:

```
# get the PPI network itself
wget https://stringdb-static.org/download/protein.links.detailed.v11.0/9606.protein.links.detailed.v11.0.txt.gz
# get aliases
wget https://stringdb-static.org/download/protein.aliases.v11.0/9606.protein.aliases.v11.0.txt.gz
``` 

Note: these links become available after filtering by first choosing an organism.

And then process them so they are easier to use:

```{r process_data, eval = FALSE}
library(STRINGDatabaseManipulation)
# assuming data is in the file, you would do:
ppi_data = process_string_data("9606.protein.links.detailed.v11.0.txt.gz")

# save it for later
saveRDS(ppi_data, file = "tmp_ppi_data.rda")

# process aliases
protein_aliases = process_string_id("9606.protein.aliases.v11.0.txt.gz")

# save for later
saveRDS(protein_aliases, file = "tmp_aliases.rda")
```

I have smaller versions of the data files saved for examples.

```{r example_data}
library(STRINGDatabaseManipulation)
links_file = system.file("extdata", "STRING11_9606_links_raw.txt.gz", package = "STRINGDatabaseManipulation")
ppi_data = process_string_links(links_file)
head(ppi_data)

aliases_file = system.file("extdata", "STRING11_9606_aliases_raw.txt.gz", package = "STRINGDatabaseManipulation")
head(STRING11_9606_aliases)
```

## Using Data

Now lets actually do something with the STRING data. Lets find all nodes within so 3 hops of a set of starting nodes.

We will use the example data from the package.

```{r run_example_hops, warning=FALSE, message=FALSE}
set.seed(1234)
ppi_graph = string_2_tidygraph(ppi_data)
all_nodes = ppi_graph |>
  tidygraph::activate(nodes) |>
  tibble::as_tibble() |>
  dplyr::pull(name)
start_nodes = all_nodes |>
  sample(size = 10)

n_hops = 3

after_3 = find_nodes_n_hops(ppi_graph, n_hops = n_hops, start_nodes = start_nodes)
after_3$graph
```

In this case nothing changed, but depending on the inputs, it might.

## Visualizing

The nice thing about using `tidygraph`, is that we have access to the `ggraph` library for visualization!

## Code of Conduct

Note that the 'STRINGDatabaseManipulation' project is released with a [Contributor Code of Conduct](CODE_OF_CONDUCT.md). By contributing to this project, you agree to abide by its terms.

